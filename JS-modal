class CardMasthead {
  component: HTMLElement;

  constructor(component: HTMLElement) {
    this.component = component;
    this.init();
  }

  init(): void {
    console.log('Card Masthead initialized');

    const offerBannerEl = document.getElementById('offerBanner');
    const mobileBannerEl = document.getElementById('mobileBanner');
    const cardOffer = document.querySelector('.uc-background__container--lightgray') as HTMLElement;
    const expiryDateEl = document.getElementById('customDate');

    // Sticky scroll: hide when near top, show when scrolling down
    window.addEventListener('scroll', () => {
      const scrollTop = window.scrollY || document.documentElement.scrollTop;
      if (scrollTop < 50) {
        this.component.classList.add('hidden');
      } else {
        this.component.classList.remove('hidden');
      }
    });

    // Expiry logic
    if (expiryDateEl) {
      const currentDate = new Date();
      const expiryDate = new Date(expiryDateEl.innerText);

      if (expiryDate <= currentDate) {
        offerBannerEl && (offerBannerEl.style.display = 'none');
        mobileBannerEl && (mobileBannerEl.style.display = 'none');
        cardOffer && (cardOffer.style.paddingTop = '0px');
        cardOffer && (cardOffer.style.paddingBottom = '0px');
      } else {
        const isMobile = (): boolean => window.innerWidth < 768;
        if (isMobile() && offerBannerEl) {
          offerBannerEl.style.display = 'none';
        }
      }
    }
  }
}

export default function CardMastheadComponent({ component }: { component: HTMLElement }): void {
  new CardMasthead(component);
}
